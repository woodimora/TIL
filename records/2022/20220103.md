# 커넥션 풀(Connection pool)

## 커넥션풀(DBCP) 란?
웹 컨테이너(WAS)가 실행되면서 DB와 미리 connection(연결)을 해놓은 객체들을 pool에 저장해두었다가 클라이언트 요청이 오면 connection을 빌려주고, 처리가 끝나면 다시 connection을 반납받아 pool에 저장하는 방식을 말한다.

## 커넥션풀(DBCP)를 사용하는 이유
DB에 직접 연결해서 처리할 때, 사용자가 요청을 할때마다 드라이버를 로드하고 커넥션 객체를 생성하여 연결하고 종료하기 때문에 매우 비효율적이다. 그래서 이를 해결하기 위해서 커넥션풀을 사용한다.

## 커넥션 풀 특징
- 웹 컨테이너(WAS)가 실행되면서 connection 객체를 미리 pool에 생성해 둔다.
- HTTP 요청에 따라 pool에서 connection 객체를 가져다 쓰고 반환한다.
- 같은 방식으로 물리적인 데이터베이스 connection 부하를 줄이고 연결 관리 한다.
- pool에 미리 connection이 생성되어 있기 때문에 connection을 생성하는 데 드는 요청마다 연결 시간이 소비되지 않는다.
- 커넥션을 계속해서 재사용하기 때문에 생성되는 커넥션 수를 제한적으로 설정한다.

## 동시 접속자가 많을 경우
- 동시 접속 할 경우 pool에서 미리 생성된 connection을 제공하고 없을 경우는 사용자는 connection이 반환될 때까지 번호순서대로 대기상태로 기다린다.
- WAS에서 커넥션풀을 크게 설정하면 메모리 소모가 큰 대신 많은 사용자가 대기시간이 줄어들고, 반대로 커넥션 풀을 적게 설정하면 그 만큼 대기시간이 길어진다.