# 오늘의 경험
### 1. 로그아웃 후 뒤로가기를 눌렀을 때, 권한이 없는 화면을 안뜨게 하고싶어요.
알아낸 방법으로는 window.location.href 을 window.location.replace()로 대체하는 것이다. location.href 는 새로운 페이지로 이동되는 것이고, location.replace는 기존 페이지를 새로운 페이지로 변경 시킨다. 그리고 location.href는 history에 기록되는 반면에 replace는 기록이 되지 않는다.
<br>
적용시켜본 결과 둘 다 똑같이 이전 화면이 나온다. 하지만 차이점은 새로고침 시 로그인 페이지로 이동 되었을 때, 다시 뒤로가기를 누르면 href는 그대로 이전 화면이 나오는 대신에 replace는 이전 페이지 대신 로그인 페이지가 대체된 것이기 때문에 더 이상 뒤로가기를 눌러도 그 페이지는 나오지 않았다. 반만 성공한 느낌이긴 하지만 괜찮은 시도였던 것 같다.
<br>
<br>

### 2. 로컬 스토리지? 세션 스토리지? 쿠키?
둘 사이에 큰 차이점은 데이터의 `영구성`이다. 로컬 스토리지는 해당 사용자의 컴퓨터에 저장되는 것으로 사용자가 지우지 않는 이상 계속 브라우저에 남아있다. 하지만 세션 스토리지는 사용자가 브라우저 탭을 닫을 경우 제거된다. 그래서 로그인 정보를 로컬이나 세션에 저장하는 경우가 있다.   
쿠키는 Key와 Value형태로 저장되는 저장소 이다. 쿠키는 매 요청마다 포함되어 전송된다. 그래서 쿠키에 많은 데이터를 싣게되면 매 전송 때마다 전송되므로 데이터가 낭비된다.   
그리고 모든 스토리지에는 용량의 한계가 있다. 세션이나 로컬은 쿠키에 비해 용량이 큰 편이다.    
유저의 게시물 작성상태를 로컬 스토리지에 저장하여 사용했는데 생각해보니 로그인 할 떄마다 해당 값을 클라이언트에 전달 해주니 굳이 로컬 스토리지에 저장하는 것 보다는 쿠키에 저장하는 것도 괜찮았을 것 같다.
<br>
<br>
Javascript에서 로컬 스토리지에 저장하는 함수는 다음과 같다.
```javascript
localStorage.setItem('Key','Value')
```
<br>


### 3. mongodb에서 작성 날짜를 이용하여 해당 날짜에 작성된 게시물을 불러오기
datetime을 import하여 사용하며 작성일을 기준으로 비교하기 위해서는 저장 타입이 동일 하여야 한다. 그냥 dateitme.today()로 db에 저장하고 오늘 날짜를 주는 datetime.date()만 이용해서는 서로 데이터 타입이 다르기 때문에 비교를 할 수 없다. 그래서 타입을 맞춰주기 위해서 isoformat을 사용하면 동일한 형태로 저장되고 비교할 수 있으므로 원하는 결과 값을 얻을 수 있었다.
```python
datetime.date().isoformat()
list(db.boards.find({'memberId': member_id, 'createDate': {'$gte': today}}))
```

### 4. JWT 토큰
JWT 토큰은 `.`으로 3가지로 나뉘어져 있으며 header, payload, verify signature 로 이루어져 있다. JWT(Json Web Token) 는 말그대로 JSON 형식으로 구성되어 있다. header에는 알고리즘과 token type 정보가, Data에는 인증, 인가 정보와 같은 데이터가 포함되어 있다. 이를 claim이라 한다. 마지막에는 secret key를 포함하여 암호화 되어있다. 쿠키나 세션으로 인증을 하는 방식은 하나의 서버에서 관리하고 처리를 해줘야하는 상태 의존적이고 별도의 저장 공간으 두어야 했다. 그러나 jwt를 사용하면 하나의 서버로만 관리할 필요 없이 여러 서버에서 동일하게 처리할 수 있으므로 상태 의존적이지 않아 서버를 여러대를 둘 수 있으며 확장성이 좋다. 또한 별도 데이터 저장소가 필요 없다.
<br>
로그인 할 때 많이 사용하며, refresh token, access token 방식으로 많이 사용한다. access token은 서버 접근 권한을 위한 토큰이며 토큰 만료시간이 짧다.
이 때, access token이 만료되면 refresh 토큰으로 다시 access token과 refresh token을 발급 해준다.